{"Version": "2012-10-17", "Statement": [{"Condition": {"StringEquals": {"ec2:CreateAction": ["CreateSnapshot", "CreateSnapshots", "CopySnapshot"]}, "ForAnyValue:StringEquals": {"aws:TagKeys": ["Orca"]}}, "Action": ["ec2:CreateTags"], "Resource": "arn:aws:ec2:*::snapshot/*", "Effect": "Allow"}, {"Condition": {"StringLike": {"ec2:ResourceTag/Orca": "*"}, "StringNotLikeIfExists": {"ec2:ResourceTag/OrcaOptOut": "*"}}, "Action": ["ec2:DeleteSnapshot"], "Resource": "*", "Effect": "Allow"}, {"Condition": {"StringNotLikeIfExists": {"ec2:ResourceTag/OrcaOptOut": "*"}}, "Action": ["ec2:CreateSnapshots", "ec2:CreateSnapshot", "ec2:CopySnapshot", "ec2:ModifySnapshotAttribute"], "Resource": "*", "Effect": "Allow"}, {"Condition": {"StringLike": {"kms:ViaService": "ec2.*.amazonaws.com"}, "StringNotLikeIfExists": {"aws:ResourceTag/OrcaOptOut": "*"}}, "Action": ["kms:ReEncryptFrom", "kms:ReEncryptTo", "kms:Encrypt", "kms:Decrypt", "kms:GenerateDataKeyWithoutPlaintext", "kms:CreateGrant"], "Resource": "*", "Effect": "Allow"}, {"Condition": {"StringNotLikeIfExists": {"aws:ResourceTag/OrcaOptOut": "*"}}, "Action": ["kms:PutKeyPolicy"], "Resource": "*", "Effect": "Allow"}]}